<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="itwillbs.p2c3.boogimovie.mapper.AdminMapper">
	
<!-- 회원 리스트 조회 -->
	<select id="selectMemberList" resultType="hashmap">
		SELECT * 
		FROM member
	</select>
	
<!-- 회원 상세보기 -->
	<select id="selectMember" resultType="itwillbs.p2c3.boogimovie.vo.MemberVO">
		SELECT * 
		FROM member
		WHERE member_id = #{id}
	</select>
	
<!-- 회원 삭제 -->
	<delete id="deleteMember">
		DELETE FROM member
		WHERE member_id = #{id}
	</delete>
	
<!-- 리뷰 리스트 조회 -->
	<select id="selectReviewList" resultType="itwillbs.p2c3.boogimovie.vo.ReviewVO">
		SELECT * 
		FROM review
	</select>
	
<!-- 리뷰 삭제 -->
	<delete id="deleteReview">
		DELETE FROM review
		WHERE review_id = #{review_id}
	</delete>
	
<!-- 영화 리스트 조회 -->
	<select id="selectMovieList" resultType="hashmap">
		SELECT * 
		FROM movie
	</select>

<!-- 영화 상세보기 -->
	<select id="selectMovie" resultType="itwillbs.p2c3.boogimovie.vo.MovieVO">
		SELECT * 
		FROM movie
		WHERE movie_num = #{movie_num}
	</select>
	
<!-- 영화 수정 업데이트 -->
	<update id="updateMovie">
		<selectKey keyProperty="board_num" resultType="int" order="BEFORE">
			SELECT board_num  
			FROM board -- update를 위한 동일한 board_num 조회
		</selectKey>
		
		UPDATE movie
		SET movie_name = #{movie_name},
			movie_director = #{movie_director},
			movie_poster = #{movie_poster},
			stillcut_num = #{stillcut_num},
			movie_trailler = #{movie_trailler},
			movie_open_date = #{movie_open_date},
			movie_status = #{movie_status},
			genre_name = #{genre_name},
			movie_grade = #{movie_grade},
			movie_summary = #{movie_summary}
		WHERE movie_num = #{movie_num}
	</update>
	
<!-- 공지사항 입력 -->
	<insert id="insertNotice" >
		<selectKey keyProperty="theater_num" resultType="int" order="BEFORE">
			SELECT theater_num FROM theater WHERE theater_name = #{theater_name}
		</selectKey>
		
	INSERT INTO notice (notice_num, notice_subject, notice_content, theater_num, notice_date )
	VALUES (null, #{notice.notice_subject}, #{notice.notice_content}, #{theater_num}, now())
		
	</insert>
	
</mapper>
